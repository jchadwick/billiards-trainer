# Billiards Trainer Implementation Plan

This plan outlines the tasks required to implement the Billiards Trainer system. The tasks are prioritized based on dependencies between the modules.

## Phase 1: Backend Development

### 1. Vision Module (Priority: 1)

-   [x] **FR-VIS-001**: Initialize and configure camera device.
-   [x] **FR-VIS-002**: Capture continuous video stream.
-   [x] **FR-VIS-003**: Support multiple camera backends.
-   [x] **FR-VIS-004**: Handle camera disconnection and reconnection.
-   [x] **FR-VIS-005**: Provide camera status and health monitoring.
-   [x] **FR-VIS-006**: Convert color spaces (BGR to HSV/LAB).
-   [x] **FR-VIS-007**: Apply noise reduction and image smoothing.
-   [x] **FR-VIS-008**: Perform automatic exposure and white balance correction.
-   [x] **FR-VIS-009**: Crop to region of interest (ROI).
-   [x] **FR-VIS-010**: Handle varying lighting conditions adaptively.
-   [x] **FR-VIS-011**: Detect pool table edges.
-   [x] **FR-VIS-012**: Identify table corners.
-   [x] **FR-VIS-013**: Distinguish table surface from surrounding environment.
-   [x] **FR-VIS-014**: Handle partial table visibility and occlusions.
-   [x] **FR-VIS-015**: Validate detected table dimensions against expected ratios.
-   [x] **FR-VIS-016**: Locate all six pockets on the table.
-   [x] **FR-VIS-017**: Determine pocket size and shape.
-   [x] **FR-VIS-018**: Track pocket positions relative to table boundaries.
-   [x] **FR-VIS-019**: Handle different pocket styles (corner vs side).
-   [x] **FR-VIS-020**: Detect all balls on the table surface.
-   [x] **FR-VIS-021**: Distinguish between different ball types.
-   [x] **FR-VIS-022**: Identify ball numbers/patterns when visible.
-   [x] **FR-VIS-023**: Track ball positions with Â±2 pixel accuracy.
-   [x] **FR-VIS-024**: Measure ball radius for size validation.
-   [x] **FR-VIS-025**: Track ball movement across frames.
-   [x] **FR-VIS-026**: Predict ball positions during fast movement.
-   [x] **FR-VIS-027**: Handle ball occlusions (by cue, hands, etc.).
-   [x] **FR-VIS-028**: Detect stationary vs moving balls.
-   [x] **FR-VIS-029**: Calculate ball velocity and acceleration.
-   [x] **FR-VIS-030**: Detect cue stick.
-   [x] **FR-VIS-031**: Determine cue angle.
-   [x] **FR-VIS-032**: Track cue tip position.
-   [x] **FR-VIS-033**: Detect cue movement patterns (aiming vs striking).
-   [x] **FR-VIS-034**: Handle multiple cue sticks in frame.
-   [x] **FR-VIS-035**: Identify when cue contacts ball.
-   [x] **FR-VIS-036**: Estimate strike force from cue velocity.
-   [x] **FR-VIS-037**: Determine strike point on cue ball.
-   [x] **FR-VIS-038**: Detect English/spin application.
-   [x] **FR-VIS-039**: Perform automatic camera calibration.
-   [x] **FR-VIS-040**: Calculate camera intrinsic parameters.
-   [x] **FR-VIS-041**: Determine camera-to-table transformation.
-   [x] **FR-VIS-042**: Compensate for lens distortion.
-   [x] **FR-VIS-043**: Support manual calibration adjustment.
-   [x] **FR-VIS-044**: Auto-detect optimal color thresholds.
-   [x] **FR-VIS-045**: Adapt to ambient lighting changes.
-   [x] **FR-VIS-046**: Provide color picker interface.
-   [x] **FR-VIS-047**: Save and load calibration profiles.

### 2. Core Module (Priority: 2)

-   [x] **FR-CORE-001**: Maintain current positions of all balls on the table.
-   [x] **FR-CORE-002**: Track cue stick position and orientation.
-   [x] **FR-CORE-003**: Store table dimensions and pocket locations.
-   [x] **FR-CORE-004**: Maintain game history for last N frames.
-   [x] **FR-CORE-005**: Detect and track game events (shots, collisions, pocketed balls).
-   [x] **FR-CORE-006**: Validate detection data for physical consistency.
-   [x] **FR-CORE-007**: Filter noise and impossible state transitions.
-   [ ] **FR-CORE-008**: Interpolate missing data points.
-   [x] **FR-CORE-009**: Detect and correct detection errors.
-   [x] **FR-CORE-010**: Maintain confidence scores for state elements.
-   [x] **FR-CORE-011**: Synchronize state across all connected clients.
-   [ ] **FR-CORE-012**: Handle state conflicts and resolution.
-   [ ] **FR-CORE-013**: Provide state snapshots for new connections.
-   [x] **FR-CORE-014**: Support state rollback and replay.
-   [x] **FR-CORE-015**: Maintain state consistency during updates.
-   [x] **FR-CORE-016**: Calculate linear ball trajectories.
-   [x] **FR-CORE-017**: Compute collision points with other balls.
-   [x] **FR-CORE-018**: Predict ball paths after collisions.
-   [x] **FR-CORE-019**: Calculate rebounds off table cushions.
-   [x] **FR-CORE-020**: Determine if balls will be pocketed.
-   [x] **FR-CORE-021**: Model ball spin (English) effects.
-   [x] **FR-CORE-022**: Calculate friction and deceleration.
-   [x] **FR-CORE-023**: Simulate masse and jump shots.
-   [ ] **FR-CORE-024**: Account for table slope/imperfections.
-   [ ] **FR-CORE-025**: Predict multi-ball collision chains.
-   [x] **FR-CORE-026**: Estimate strike force from cue velocity.
-   [x] **FR-CORE-027**: Calculate impact point on cue ball.
-   [ ] **FR-CORE-028**: Determine shot power requirements.
-   [ ] **FR-CORE-029**: Suggest optimal force for shots.
-   [ ] **FR-CORE-030**: Validate physically possible shots.
-   [x] **FR-CORE-031**: Identify shot type (break, safety, bank, etc.).
-   [x] **FR-CORE-032**: Calculate shot difficulty score.
-   [x] **FR-CORE-033**: Detect illegal shots (scratches, wrong ball).
-   [x] **FR-CORE-034**: Suggest alternative shot angles.
-   [x] **FR-CORE-035**: Rank shots by success probability.
-   [x] **FR-CORE-036**: Track game type (8-ball, 9-ball, etc.).
-   [ ] **FR-CORE-037**: Monitor turn order and fouls.
-   [x] **FR-CORE-038**: Validate legal shots per game rules.
-   [ ] **FR-CORE-039**: Track score and game progress.
-   [x] **FR-CORE-040**: Detect game completion conditions.
-   [x] **FR-CORE-041**: Predict ball positions for next 5 seconds.
-   [x] **FR-CORE-042**: Calculate collision sequences.
-   [x] **FR-CORE-043**: Estimate final resting positions.
-   [x] **FR-CORE-044**: Predict shot success probability.
-   [x] **FR-CORE-045**: Identify potential problems/scratches.
-   [x] **FR-CORE-046**: Suggest optimal aiming points.
-   [x] **FR-CORE-047**: Recommend shot power levels.
-   [x] **FR-CORE-048**: Identify best target balls.
-   [x] **FR-CORE-049**: Show safe zones for cue ball.
-   [x] **FR-CORE-050**: Provide difficulty-adjusted assistance.
-   [x] **FR-CORE-051**: Receive detection data from Vision module.
-   [x] **FR-CORE-052**: Send state updates to API module.
-   [x] **FR-CORE-053**: Provide trajectory data to Projector module.
-   [x] **FR-CORE-054**: Exchange configuration with Config module.
-   [x] **FR-CORE-055**: Coordinate module initialization and shutdown.
-   [x] **FR-CORE-056**: Generate system events for state changes.
-   [x] **FR-CORE-057**: Handle event subscriptions from modules.
-   [x] **FR-CORE-058**: Maintain event history and replay.
-   [x] **FR-CORE-059**: Filter and route events by type.
-   [x] **FR-CORE-060**: Support custom event handlers.

### 3. API Module (Priority: 3)

-   [x] **FR-API-001**: Provide health check endpoint.
-   [x] **FR-API-002**: Expose system version and capability information.
-   [x] **FR-API-003**: Enable graceful shutdown and restart operations.
-   [x] **FR-API-004**: Provide performance metrics and statistics.
-   [x] **FR-API-005**: Retrieve current system configuration.
-   [x] **FR-API-006**: Update configuration parameters with validation.
-   [x] **FR-API-007**: Reset configuration to defaults.
-   [x] **FR-API-008**: Import/export configuration files.
-   [x] **FR-API-009**: Initiate calibration sequence.
-   [x] **FR-API-010**: Capture calibration reference points.
-   [x] **FR-API-011**: Apply calibration transformations.
-   [x] **FR-API-012**: Validate calibration accuracy.
-   [x] **FR-API-013**: Retrieve current game state snapshot.
-   [x] **FR-API-014**: Access historical game states.
-   [x] **FR-API-015**: Reset game state tracking.
-   [x] **FR-API-016**: Export game session data.
-   [x] **FR-WS-001**: Stream processed video frames.
-   [x] **FR-WS-002**: Broadcast game state updates.
-   [x] **FR-WS-003**: Send trajectory calculations in real-time.
-   [x] **FR-WS-004**: Push system alerts and notifications.
-   [x] **FR-WS-005**: Support multiple concurrent WebSocket connections.
-   [x] **FR-WS-006**: Implement automatic reconnection handling.
-   [x] **FR-WS-007**: Provide connection quality indicators.
-   [x] **FR-WS-008**: Enable selective subscription to data streams.
-   [ ] **FR-AUTH-001**: Implement JWT-based authentication.
-   [ ] **FR-AUTH-002**: Support role-based access control.
-   [ ] **FR-AUTH-003**: Provide API key authentication.
-   [ ] **FR-AUTH-004**: Enable session management and timeout.
-   [ ] **FR-SEC-001**: Enforce HTTPS for all communications.
-   [ ] **FR-SEC-002**: Implement rate limiting per client.
-   [ ] **FR-SEC-003**: Validate and sanitize all inputs.
-   [ ] **FR-SEC-004**: Log security events and access attempts.
-   [ ] **TODO**: Implement actual notification system (email, Slack, etc.) in `backend/api/middleware/session_monitor.py`.
-   [ ] **TODO**: Implement blocked attempts tracking in `backend/api/middleware/session_monitor.py`.
-   [ ] **TODO**: Implement concurrent limit violations from alerts in `backend/api/middleware/session_monitor.py`.

### 4. Configuration Module (Priority: 4)

-   [x] **FR-CFG-001**: Load configuration from multiple sources.
-   [x] **FR-CFG-002**: Support configuration file formats (JSON, YAML, INI).
-   [x] **FR-CFG-003**: Merge configurations with proper precedence rules.
-   [x] **FR-CFG-004**: Provide default values for all settings.
-   [x] **FR-CFG-005**: Support configuration inheritance and overrides.
-   [x] **FR-CFG-006**: Validate all configuration values against schemas.
-   [x] **FR-CFG-007**: Check value ranges and constraints.
-   [x] **FR-CFG-008**: Verify interdependent settings consistency.
-   [x] **FR-CFG-009**: Provide detailed validation error messages.
-   [x] **FR-CFG-010**: Suggest corrections for invalid values.
-   [x] **FR-CFG-011**: Save configuration changes to persistent storage.
-   [x] **FR-CFG-012**: Maintain configuration history/versions.
-   [x] **FR-CFG-013**: Support atomic configuration updates.
-   [x] **FR-CFG-014**: Provide configuration backup and restore.
-   [x] **FR-CFG-015**: Handle concurrent configuration access.
-   [x] **FR-CFG-016**: Apply configuration changes without restart.
-   [x] **FR-CFG-017**: Notify modules of relevant changes.
-   [x] **FR-CFG-018**: Support configuration hot-reload.
-   [x] **FR-CFG-019**: Rollback failed configuration changes.
-   [x] **FR-CFG-020**: Queue configuration changes for batch application.
-   [x] **FR-CFG-021**: Allow modules to register configuration needs.
-   [x] **FR-CFG-022**: Track which modules use which settings.
-   [x] **FR-CFG-023**: Validate module-specific configurations.
-   [x] **FR-CFG-024**: Provide module configuration interfaces.
-   [x] **FR-CFG-025**: Handle module configuration conflicts.
-   [x] **FR-CFG-026**: Support multiple named configuration profiles.
-   [x] **FR-CFG-027**: Switch between profiles at runtime.
-   [x] **FR-CFG-028**: Import and export profiles.
-   [x] **FR-CFG-029**: Merge profiles with base configuration.
-   [x] **FR-CFG-030**: Auto-select profiles based on conditions.
-   [ ] **FR-CFG-031**: Store user-specific preferences.
-   [ ] **FR-CFG-032**: Support per-user configuration overrides.
-   [ ] **FR-CFG-033**: Migrate user settings between versions.
-   [ ] **FR-CFG-034**: Reset preferences to defaults.
-   [ ] **FR-CFG-035**: Track preference usage statistics.
-   [ ] **FR-CFG-036**: Detect runtime environment (dev, test, prod).
-   [ ] **FR-CFG-037**: Load environment-specific configurations.
-   [x] **FR-CFG-038**: Override settings with environment variables.
-   [ ] **FR-CFG-039**: Validate environment compatibility.
-   [x] **FR-CFG-040**: Support Docker/container environments.
-   [ ] **FR-CFG-041**: Detect available hardware capabilities.
-   [ ] **FR-CFG-042**: Auto-configure based on hardware.
-   [ ] **FR-CFG-043**: Warn about hardware limitations.
-   [ ] **FR-CFG-044**: Optimize settings for performance.
-   [ ] **FR-CFG-045**: Handle hardware changes dynamically.
-   [x] **FR-CFG-046**: Provide typed configuration access methods.
-   [x] **FR-CFG-047**: Support configuration queries and searches.
-   [x] **FR-CFG-048**: Enable configuration subscriptions.
-   [x] **FR-CFG-049**: Provide configuration metadata.
-   [x] **FR-CFG-050**: Support configuration transactions.
-   [x] **FR-CFG-051**: Expose configuration REST API.
-   [ ] **FR-CFG-052**: Provide configuration CLI tools.
-   [x] **FR-CFG-053**: Support bulk configuration operations.
-   [x] **FR-CFG-054**: Enable configuration import/export.
-   [ ] **FR-CFG-055**: Provide configuration documentation.

### 5. Projector Module (Priority: 5)

-   [x] **FR-PROJ-001**: Initialize projector display output.
-   [ ] **FR-PROJ-002**: Detect and configure available display devices.
-   [x] **FR-PROJ-003**: Support multiple display resolutions.
-   [x] **FR-PROJ-004**: Handle projector disconnection and reconnection.
-   [x] **FR-PROJ-005**: Provide projector status and health monitoring.
-   [x] **FR-PROJ-006**: Render trajectory lines.
-   [x] **FR-PROJ-007**: Display collision indicators.
-   [x] **FR-PROJ-008**: Show ball path predictions with fade effects.
-   [x] **FR-PROJ-009**: Render aiming assistance guides.
-   [x] **FR-PROJ-010**: Display success probability indicators.
-   [x] **FR-PROJ-011**: Perform 4-point perspective transformation.
-   [x] **FR-PROJ-012**: Support keystone correction.
-   [x] **FR-PROJ-013**: Compensate for barrel/pincushion distortion.
-   [x] **FR-PROJ-014**: Handle non-perpendicular projector positioning.
-   [x] **FR-PROJ-015**: Save and load calibration profiles.
-   [x] **FR-PROJ-016**: Display calibration grid pattern.
-   [x] **FR-PROJ-017**: Allow manual corner point adjustment.
-   [x] **FR-PROJ-018**: Provide automatic alignment detection.
-   [x] **FR-PROJ-019**: Support fine-tuning with arrow keys.
-   [x] **FR-PROJ-020**: Validate calibration accuracy with test patterns.
-   [x] **FR-PROJ-021**: Draw primary ball trajectory lines.
-   [x] **FR-PROJ-022**: Show reflection paths off cushions.
-   [x] **FR-PROJ-023**: Display collision transfer trajectories.
-   [x] **FR-PROJ-024**: Indicate pocket entry paths.
-   [x] **FR-PROJ-025**: Show spin effect curves.
-   [x] **FR-PROJ-026**: Apply gradient colors to indicate force/speed.
-   [x] **FR-PROJ-027**: Animate trajectory appearance/disappearance.
-   [x] **FR-PROJ-028**: Pulse or highlight recommended shots.
-   [x] **FR-PROJ-029**: Show ghost balls for aiming reference.
-   [x] **FR-PROJ-030**: Display impact zones with transparency.
-   [x] **FR-PROJ-031**: Show shot difficulty indicators.
-   [x] **FR-PROJ-032**: Display angle measurements.
-   [x] **FR-PROJ-033**: Present force/power recommendations.
-   [x] **FR-PROJ-034**: Show success probability percentages.
-   [x] **FR-PROJ-035**: Display system messages and alerts.
-   [x] **FR-PROJ-036**: Connect to backend via WebSocket.
-   [x] **FR-PROJ-037**: Receive trajectory updates in real-time.
-   [x] **FR-PROJ-038**: Handle game state changes.
-   [x] **FR-PROJ-039**: Process configuration updates.
-   [x] **FR-PROJ-040**: Manage connection failures and reconnection.
-   [x] **FR-PROJ-041**: Synchronize display with camera frame rate.
-   [x] **FR-PROJ-042**: Maintain smooth animation at 60 FPS.
-   [x] **FR-PROJ-043**: Minimize latency between detection and display.
-   [x] **FR-PROJ-044**: Handle frame dropping gracefully.
-   [x] **FR-PROJ-045**: Interpolate between updates for smoothness.
-   [x] **FR-PROJ-046**: Configure line thickness and styles.
-   [x] **FR-PROJ-047**: Adjust color schemes and themes.
-   [x] **FR-PROJ-048**: Set transparency/opacity levels.
-   [x] **FR-PROJ-049**: Choose animation speeds.
-   [x] **FR-PROJ-050**: Select information display modes.
-   [x] **FR-PROJ-051**: Show/hide different trajectory types.
-   [x] **FR-PROJ-052**: Adjust assistance based on skill level.
-   [x] **FR-PROJ-053**: Toggle specific visual aids on/off.
-   [x] **FR-PROJ-054**: Configure information density.
-   [x] **FR-PROJ-055**: Support practice vs competition modes.

## Phase 2: Frontend Development

### 1. Frontend Web Application (Priority: 6)

-   [x] **FR-UI-001**: Display real-time camera feed.
-   [ ] **FR-UI-002**: Support adaptive video quality.
-   [x] **FR-UI-003**: Show overlay of detected objects on video.
-   [ ] **FR-UI-004**: Enable full-screen video mode.
-   [ ] **FR-UI-005**: Provide zoom and pan controls.
-   [x] **FR-UI-006**: Render ball positions and IDs on video.
-   [x] **FR-UI-007**: Display table boundary detection.
-   [x] **FR-UI-008**: Show cue stick position and angle.
-   [x] **FR-UI-009**: Highlight pocket locations.
-   [x] **FR-UI-010**: Display confidence scores for detections.
-   [x] **FR-UI-011**: Render predicted ball paths in real-time.
-   [x] **FR-UI-012**: Show collision points and bounces.
-   [x] **FR-UI-013**: Display different trajectory types with colors.
-   [x] **FR-UI-014**: Animate trajectory updates smoothly.
-   [x] **FR-UI-015**: Show probability/confidence for predictions.
-   [ ] **FR-UI-016**: Provide camera calibration wizard.
-   [ ] **FR-UI-017**: Allow table corner adjustment.
-   [ ] **FR-UI-018**: Support color threshold tuning.
-   [ ] **FR-UI-019**: Display calibration test patterns.
-   [ ] **FR-UI-020**: Save and load calibration profiles.
-   [ ] **FR-UI-021**: Display all system settings.
-   [ ] **FR-UI-022**: Provide form-based configuration editing.
-   [ ] **FR-UI-023**: Validate settings before applying.
-   [ ] **FR-UI-024**: Show setting descriptions and help text.
-   [ ] **FR-UI-025**: Support configuration import/export.
-   [ ] **FR-UI-026**: Start/stop detection processing.
-   [ ] **FR-UI-027**: Reset game state.
-   [ ] **FR-UI-028**: Clear trajectory predictions.
-   [ ] **FR-UI-029**: Switch between assistance levels.
-   [ ] **FR-UI-030**: Control projector output on/off.
-   [ ] **FR-UI-031**: Display real-time FPS counter.
-   [ ] **FR-UI-032**: Show processing latency graph.
-   [ ] **FR-UI-033**: Monitor CPU and memory usage.
-   [ ] **FR-UI-034**: Track detection accuracy metrics.
-   [ ] **FR-UI-035**: Display network bandwidth usage.
-   [ ] **FR-UI-036**: Show connection status for all components.
-   [ ] **FR-UI-037**: Display camera and projector health.
-   [ ] **FR-UI-038**: List active WebSocket connections.
-   [ ] **FR-UI-039**: Show error and warning messages.
-   [ ] **FR-UI-040**: Provide system uptime information.
-   [ ] **FR-UI-041**: Display scrollable event history.
-   [ ] **FR-UI-042**: Filter events by type and severity.
-   [ ] **FR-UI-043**: Search events by keyword.
-   [ ] **FR-UI-044**: Export event logs.
-   [ ] **FR-UI-045**: Clear event history.
-   [ ] **FR-UI-046**: Provide responsive layout.
-   [ ] **FR-UI-047**: Support customizable dashboard panels.
-   [ ] **FR-UI-048**: Enable drag-and-drop panel arrangement.
-   [ ] **FR-UI-049**: Save and restore layout preferences.
-   [ ] **FR-UI-050**: Support dark and light themes.
-   [ ] **FR-UI-051**: Provide main navigation menu.
-   [ ] **FR-UI-052**: Support keyboard shortcuts.
-   [ ] **FR-UI-053**: Enable breadcrumb navigation.
-   [ ] **FR-UI-054**: Provide context-sensitive help.
-   [ ] **FR-UI-055**: Support browser back/forward.
-   [ ] **FR-UI-056**: Support screen readers (ARIA labels).
-   [ ] **FR-UI-057**: Provide keyboard-only navigation.
-   [ ] **FR-UI-058**: Support high contrast mode.
-   [ ] **FR-UI-059**: Enable font size adjustment.
-   [ ] **FR-UI-060**: Provide alternative text for images.
-   [ ] **FR-UI-061**: Adapt layout for mobile phones.
-   [ ] **FR-UI-062**: Optimize for tablet displays.
-   [ ] **FR-UI-063**: Support desktop widescreen layouts.
-   [D] **FR-UI-064**: Handle portrait and landscape orientations.
-   [ ] **FR-UI-065**: Provide touch-friendly controls.
-   [ ] **FR-UI-066**: Support Chrome 90+.
-   [ ] **FR-UI-067**: Support Firefox 88+.
-   [ ] **FR-UI-068**: Support Safari 14+.
-   [ ] **FR-UI-069**: Support Edge 90+.
-   [ ] **FR-UI-070**: Graceful degradation for older browsers.